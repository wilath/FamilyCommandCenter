{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class TasksService {\n  constructor() {\n    this.taskList$ = new BehaviorSubject([]);\n    this.memberList$ = new BehaviorSubject([]);\n    this.history$ = new BehaviorSubject([]);\n    this.activeMember = '';\n    const taskList = [{\n      id: 528,\n      name: 'Water Plants',\n      created: new Date('2023-04-23 18:10:53'),\n      isDone: false,\n      member: 'John',\n      assignedBy: 'Daphne',\n      importance: 'normal',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 529,\n      name: 'Walk the dog',\n      created: new Date('2023-03-22 17:10:10'),\n      isDone: false,\n      member: 'Mark',\n      assignedBy: 'Daphne',\n      importance: 'low',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 530,\n      name: 'Grocery shopping',\n      created: new Date('2024-07-21 20:05:55'),\n      isDone: false,\n      member: 'Mark',\n      assignedBy: 'Mark',\n      importance: 'high',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 531,\n      name: 'Change sheets',\n      created: new Date('2023-02-21 03:29:11'),\n      isDone: false,\n      member: 'Daphne',\n      assignedBy: 'Mark',\n      importance: 'high',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 532,\n      name: 'Learn Angular',\n      created: new Date('2023-04-23 15:11:11'),\n      isDone: false,\n      member: 'Daphne',\n      assignedBy: 'Daphne',\n      importance: 'normal',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 533,\n      name: 'Clean the kitchen',\n      created: new Date('2023-03-21 13:19:14'),\n      end: new Date('2022-07-25 18:29:41'),\n      isDone: true,\n      member: 'Julian',\n      assignedBy: 'Mark',\n      importance: 'low',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 534,\n      name: 'Laundry',\n      created: new Date('2023-02-05 05:21:57'),\n      end: new Date('2022-07-25 18:54:11'),\n      isDone: true,\n      member: 'Julian',\n      assignedBy: 'Mark',\n      importance: 'low',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 526,\n      name: 'Wash the car',\n      created: new Date('2023-02-04 01:21:54'),\n      isDone: false,\n      member: 'John',\n      assignedBy: 'John',\n      importance: 'low',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 525,\n      name: 'Wrap presents',\n      created: new Date('2023-02-03 04:11:57'),\n      isDone: false,\n      member: 'Julian',\n      assignedBy: 'John',\n      importance: 'low',\n      deadline: new Date('2023-05-23 18:10:53')\n    }, {\n      id: 527,\n      name: 'Clean the fireplace',\n      created: new Date('2023-02-04 05:11:17'),\n      isDone: false,\n      member: 'Julian',\n      assignedBy: 'Mark',\n      importance: 'normal',\n      deadline: new Date('2023-05-23 18:10:53')\n    }];\n    const members = [{\n      name: 'John',\n      class: 'Adult',\n      color: 'var(--fandango)'\n    }, {\n      name: 'Daphne',\n      class: 'Adult',\n      color: 'var(--thulian-pink)'\n    }, {\n      name: 'Mark',\n      class: 'Child',\n      color: 'var(--dutch-white)'\n    }, {\n      name: 'Julian',\n      class: 'Child',\n      color: 'var(--ice-blue)'\n    }];\n    const storedHistory = localStorage.getItem('history');\n    const storedMembers = localStorage.getItem('members');\n    const storedTasks = localStorage.getItem('tasks');\n    if (storedHistory && storedMembers && storedTasks) {\n      console.log(storedHistory);\n      this.history$.next(JSON.parse(storedHistory));\n      this.memberList$.next(JSON.parse(storedMembers));\n      this.taskList$.next(JSON.parse(storedTasks));\n    } else {\n      this.memberList$.next(members);\n      this.taskList$.next(taskList);\n      for (let i = 0; i < taskList.length; i++) {\n        this.addTaskToHistory(taskList[i], 'add');\n      }\n      localStorage.setItem(\"members\", JSON.stringify(members));\n      localStorage.setItem(\"tasks\", JSON.stringify(taskList));\n      localStorage.setItem(\"history\", JSON.stringify(this.history$.getValue()));\n    }\n  }\n  add(task) {\n    const list = this.taskList$.getValue();\n    list.push(task);\n    this.taskList$.next(list);\n    this.addTaskToHistory(task, 'add');\n  }\n  addMember(member) {\n    const mem = this.memberList$.getValue();\n    mem.push(member);\n    this.memberList$.next(mem);\n    localStorage.setItem('members', JSON.stringify(mem));\n    this.addMemberToHistory(member, 'add');\n  }\n  deleteMember(member, active) {\n    var list = this.taskList$.getValue();\n    var mems = this.memberList$.getValue();\n    const index = mems.findIndex(e => e.name === active);\n    if (member === 'delete') {\n      list = list.filter(e => e.member !== active);\n      this.taskList$.next(list);\n    } else {\n      list = list.map(item => {\n        if (item.member === active) {\n          return {\n            ...item,\n            member: member\n          };\n        } else {\n          return item;\n        }\n      });\n      this.taskList$.next(list);\n    }\n    this.addMemberToHistory(mems[index], 'delete');\n    mems.splice(index, 1);\n  }\n  done(task) {\n    task.end = new Date();\n    task.isDone = true;\n    var list = this.taskList$.getValue();\n    this.taskList$.next(list);\n    this.addTaskToHistory(task, 'done');\n  }\n  undone(task) {\n    task.isDone = false;\n    delete task.end;\n    let list = this.taskList$.getValue();\n    this.taskList$.next(list);\n    this.addTaskToHistory(task, 'undone');\n  }\n  editTask(task, id) {\n    var list = this.taskList$.getValue();\n    const index = list.findIndex(e => e.id === id);\n    if (index !== -1) {\n      list[index].name = task.value.name;\n      list[index].deadline = task.value.deadline;\n      list[index].assignedBy = task.value.for;\n      list[index].importance = task.value.urgent;\n      list[index].created = task.value.created;\n      if (task.value.member) {\n        list[index].member = task.value.member;\n      }\n    }\n    this.taskList$.next(list);\n    this.addTaskToHistory(list[index], 'edit');\n  }\n  dropTask(id, newMember) {\n    var list = this.taskList$.getValue();\n    const index = list.findIndex(e => e.id === id);\n    if (newMember !== list[index].member) {\n      if (index !== -1) {\n        list[index].member = newMember;\n      }\n      this.taskList$.next(list);\n      this.addTaskToHistory(list[index], 'edit');\n    }\n  }\n  remove(task) {\n    var list = this.taskList$.getValue();\n    list = list.filter(e => e !== task);\n    this.taskList$.next(list);\n  }\n  deleteall() {\n    var list = this.taskList$.getValue();\n    list = [];\n    this.taskList$.next(list);\n  }\n  getTaskListObs() {\n    return this.taskList$.asObservable();\n  }\n  getMemberListObs() {\n    return this.memberList$.asObservable();\n  }\n  getHistoryListObs() {\n    return this.history$.asObservable();\n  }\n  addTaskToHistory(item, action) {\n    let cDate = item.created.toLocaleString();\n    let aDate = new Date().toLocaleDateString();\n    let eDate = item.end?.toLocaleDateString();\n    let hist = this.history$.getValue();\n    let task = '';\n    switch (action) {\n      case 'add':\n        task = cDate + ' - ' + item.assignedBy + ' added new task: ' + item.name + '(' + item.id + ')';\n        break;\n      case 'delete':\n        task = aDate + ' - ' + this.activeMember + ' deleted task: ' + item.name + '(' + item.id + ')';\n        break;\n      case 'edit':\n        task = aDate + ' - ' + this.activeMember + ' edited task: ' + item.name + '(' + item.id + ')';\n        break;\n      case 'done':\n        task = eDate + ' - ' + item.member + ' finished task: ' + item.name + '(' + item.id + ')';\n        break;\n      case 'undone':\n        task = aDate + ' - ' + this.activeMember + ' undone task: ' + item.name + '(' + item.id + ')';\n        break;\n    }\n    hist.push(task);\n    this.history$.next(hist);\n  }\n  addMemberToHistory(item, action) {\n    let date = new Date().toLocaleDateString();\n    let hist = this.history$.getValue();\n    let task = '';\n    switch (action) {\n      case 'add':\n        task = date + ' - ' + this.activeMember + ' added new member: ' + item.name;\n        break;\n      case 'delete':\n        task = date + ' - ' + this.activeMember + ' deleted member: ' + item.name;\n        break;\n      case 'edit':\n        task = date + ' - ' + this.activeMember + ' edited member: ' + item.name;\n        break;\n    }\n    hist.push(task);\n    this.history$.next(hist);\n  }\n}\nTasksService.ɵfac = function TasksService_Factory(t) {\n  return new (t || TasksService)();\n};\nTasksService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: TasksService,\n  factory: TasksService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AACA,SAASA,eAAe,QAAoB,MAAM;;AASlD,OAAM,MAAOC,YAAY;EAQvBC;IALQ,cAAS,GAAG,IAAIF,eAAe,CAAc,EAAE,CAAC;IAChD,gBAAW,GAAG,IAAIA,eAAe,CAAgB,EAAE,CAAC;IACpD,aAAQ,GAAG,IAAIA,eAAe,CAAgB,EAAE,CAAC;IAClD,iBAAY,GAAW,EAAE;IAG/B,MAAMG,QAAQ,GAAG,CACd;MAACC,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,cAAc;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,MAAM;MAAEC,UAAU,EAAE,QAAQ;MAAEC,UAAU,EAAE,QAAQ;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAE,EAChM;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,cAAc;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,MAAM;MAAEC,UAAU,EAAE,QAAQ;MAAEC,UAAU,EAAE,KAAK;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAI,EAC/L;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,kBAAkB;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,MAAM;MAAEC,UAAU,EAAE,MAAM;MAAGC,UAAU,EAAE,MAAM;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAI,EACnM;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,eAAe;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,QAAQ;MAAEC,UAAU,EAAE,MAAM;MAAEC,UAAU,EAAE,MAAM;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAI,EACjM;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,eAAe;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,QAAQ;MAACC,UAAU,EAAE,QAAQ;MAAEC,UAAU,EAAE,QAAQ;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAI,EACpM;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,mBAAmB;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEM,GAAG,EAAE,IAAIN,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,IAAI;MAAEC,MAAM,EAAE,QAAQ;MAAEC,UAAU,EAAE,MAAM;MAAEC,UAAU,EAAE,KAAK;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAG,EACxO;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,SAAS;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEM,GAAG,EAAE,IAAIN,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,IAAI;MAAEC,MAAM,EAAE,QAAQ;MAACC,UAAU,EAAE,MAAM;MAAEC,UAAU,EAAE,KAAK;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAC,EAC3N;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,cAAc;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAGC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,MAAM;MAACC,UAAU,EAAE,MAAM;MAAEC,UAAU,EAAE,KAAK;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAC,EAC1L;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,eAAe;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,QAAQ;MAACC,UAAU,EAAE,MAAM;MAAEC,UAAU,EAAE,KAAK;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAC,EAC5L;MAACH,EAAE,EAAE,GAAG;MAAEC,IAAI,EAAE,qBAAqB;MAAEC,OAAO,EAAE,IAAIC,IAAI,CAAC,qBAAqB,CAAC;MAAEC,MAAM,EAAE,KAAK;MAAEC,MAAM,EAAE,QAAQ;MAACC,UAAU,EAAE,MAAM;MAAEC,UAAU,EAAE,QAAQ;MAAEC,QAAQ,EAAE,IAAIL,IAAI,CAAC,qBAAqB;IAAC,CAAC,CACtM;IACD,MAAMO,OAAO,GAAkB,CAC7B;MAACT,IAAI,EAAE,MAAM;MAAEU,KAAK,EAAE,OAAO;MAAEC,KAAK,EAAE;IAAiB,CAAC,EACxD;MAACX,IAAI,EAAE,QAAQ;MAAEU,KAAK,EAAE,OAAO;MAAEC,KAAK,EAAE;IAAqB,CAAC,EAC9D;MAACX,IAAI,EAAE,MAAM;MAAEU,KAAK,EAAE,OAAO;MAAEC,KAAK,EAAE;IAAoB,CAAC,EAC3D;MAACX,IAAI,EAAE,QAAQ;MAAEU,KAAK,EAAE,OAAO;MAAEC,KAAK,EAAE;IAAiB,CAAC,CAC3D;IAID,MAAMC,aAAa,GAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IACrD,MAAMC,aAAa,GAAGF,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IACrD,MAAME,WAAW,GAAGH,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAEjD,IAAIF,aAAa,IAAIG,aAAa,IAAIC,WAAW,EAAE;MACjDC,OAAO,CAACC,GAAG,CAACN,aAAa,CAAC;MAC1B,IAAI,CAACO,QAAQ,CAACC,IAAI,CAACC,IAAI,CAACC,KAAK,CAACV,aAAa,CAAC,CAAC;MAC7C,IAAI,CAACW,WAAW,CAACH,IAAI,CAACC,IAAI,CAACC,KAAK,CAACP,aAAa,CAAC,CAAC;MAChD,IAAI,CAACS,SAAS,CAACJ,IAAI,CAACC,IAAI,CAACC,KAAK,CAACN,WAAW,CAAC,CAAC;KAC7C,MAAM;MAEL,IAAI,CAACO,WAAW,CAACH,IAAI,CAACX,OAAO,CAAC;MAC9B,IAAI,CAACe,SAAS,CAACJ,IAAI,CAACtB,QAAQ,CAAC;MAC7B,KAAI,IAAI2B,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG3B,QAAQ,CAAC4B,MAAM,EAAGD,CAAC,EAAE,EAAC;QACvC,IAAI,CAACE,gBAAgB,CAAC7B,QAAQ,CAAC2B,CAAC,CAAC,EAAE,KAAK,CAAC;;MAG3CZ,YAAY,CAACe,OAAO,CAAC,SAAS,EAAEP,IAAI,CAACQ,SAAS,CAACpB,OAAO,CAAC,CAAC;MACxDI,YAAY,CAACe,OAAO,CAAC,OAAO,EAAEP,IAAI,CAACQ,SAAS,CAAC/B,QAAQ,CAAC,CAAC;MACvDe,YAAY,CAACe,OAAO,CAAC,SAAS,EAAEP,IAAI,CAACQ,SAAS,CAAC,IAAI,CAACV,QAAQ,CAACW,QAAQ,EAAE,CAAC,CAAC;;EAI7E;EAKAC,GAAG,CAACC,IAAU;IACZ,MAAMC,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACtCG,IAAI,CAACC,IAAI,CAACF,IAAI,CAAC;IACf,IAAI,CAACR,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;IAEzB,IAAI,CAACN,gBAAgB,CAACK,IAAI,EAAE,KAAK,CAAC;EACpC;EACAG,SAAS,CAAC/B,MAAc;IACtB,MAAMgC,GAAG,GAAG,IAAI,CAACb,WAAW,CAACO,QAAQ,EAAE;IACvCM,GAAG,CAACF,IAAI,CAAC9B,MAAM,CAAC;IAChB,IAAI,CAACmB,WAAW,CAACH,IAAI,CAACgB,GAAG,CAAC;IAC1BvB,YAAY,CAACe,OAAO,CAAC,SAAS,EAAEP,IAAI,CAACQ,SAAS,CAACO,GAAG,CAAC,CAAC;IACpD,IAAI,CAACC,kBAAkB,CAACjC,MAAM,EAAE,KAAK,CAAC;EACxC;EACAkC,YAAY,CAAClC,MAAa,EAAEmC,MAAa;IACvC,IAAIN,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACpC,IAAIU,IAAI,GAAG,IAAI,CAACjB,WAAW,CAACO,QAAQ,EAAE;IACtC,MAAMW,KAAK,GAAGD,IAAI,CAACE,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC3C,IAAI,KAAKuC,MAAM,CAAC;IAEpD,IAAGnC,MAAM,KAAK,QAAQ,EAAC;MACrB6B,IAAI,GAAGA,IAAI,CAACW,MAAM,CAAED,CAAC,IAAIA,CAAC,CAACvC,MAAM,KAAKmC,MAAM,CAAC;MAC7C,IAAI,CAACf,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;KAE1B,MAAM;MACLA,IAAI,GAAGA,IAAI,CAACY,GAAG,CAACC,IAAI,IAAG;QACrB,IAAIA,IAAI,CAAC1C,MAAM,KAAKmC,MAAM,EAAE;UAC1B,OAAO;YAAE,GAAGO,IAAI;YAAE1C,MAAM,EAAEA;UAAM,CAAE;SACnC,MAAM;UACL,OAAO0C,IAAI;;MAEf,CAAC,CAAC;MACF,IAAI,CAACtB,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;;IAG3B,IAAI,CAACI,kBAAkB,CAACG,IAAI,CAACC,KAAK,CAAC,EAAE,QAAQ,CAAC;IAC9CD,IAAI,CAACO,MAAM,CAACN,KAAK,EAAC,CAAC,CAAC;EAEtB;EACAO,IAAI,CAAChB,IAAU;IACbA,IAAI,CAACxB,GAAG,GAAG,IAAIN,IAAI,EAAE;IACrB8B,IAAI,CAAC7B,MAAM,GAAG,IAAI;IAClB,IAAI8B,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACpC,IAAI,CAACN,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;IACzB,IAAI,CAACN,gBAAgB,CAACK,IAAI,EAAE,MAAM,CAAC;EACrC;EACAiB,MAAM,CAACjB,IAAU;IACfA,IAAI,CAAC7B,MAAM,GAAG,KAAK;IACnB,OAAO6B,IAAI,CAACxB,GAAG;IACf,IAAIyB,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACpC,IAAI,CAACN,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;IACzB,IAAI,CAACN,gBAAgB,CAACK,IAAI,EAAE,QAAQ,CAAC;EAEvC;EACAkB,QAAQ,CAAClB,IAAW,EAAEjC,EAAS;IAC7B,IAAIkC,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IAEpC,MAAMW,KAAK,GAAGR,IAAI,CAACS,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC5C,EAAE,KAAKA,EAAE,CAAC;IAE9C,IAAI0C,KAAK,KAAK,CAAC,CAAC,EAAE;MAChBR,IAAI,CAACQ,KAAK,CAAC,CAACzC,IAAI,GAAGgC,IAAI,CAACmB,KAAK,CAACnD,IAAI;MAClCiC,IAAI,CAACQ,KAAK,CAAC,CAAClC,QAAQ,GAAGyB,IAAI,CAACmB,KAAK,CAAC5C,QAAQ;MAC1C0B,IAAI,CAACQ,KAAK,CAAC,CAACpC,UAAU,GAAG2B,IAAI,CAACmB,KAAK,CAACC,GAAG;MACvCnB,IAAI,CAACQ,KAAK,CAAC,CAACnC,UAAU,GAAG0B,IAAI,CAACmB,KAAK,CAACE,MAAM;MAC1CpB,IAAI,CAACQ,KAAK,CAAC,CAACxC,OAAO,GAAG+B,IAAI,CAACmB,KAAK,CAAClD,OAAO;MACxC,IAAG+B,IAAI,CAACmB,KAAK,CAAC/C,MAAM,EAAC;QACrB6B,IAAI,CAACQ,KAAK,CAAC,CAACrC,MAAM,GAAG4B,IAAI,CAACmB,KAAK,CAAC/C,MAAM;;;IAIxC,IAAI,CAACoB,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;IACzB,IAAI,CAACN,gBAAgB,CAACM,IAAI,CAACQ,KAAK,CAAC,EAAE,MAAM,CAAC;EAC5C;EACAa,QAAQ,CAACvD,EAAS,EAAEwD,SAAgB;IAClC,IAAItB,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACpC,MAAMW,KAAK,GAAGR,IAAI,CAACS,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC5C,EAAE,KAAKA,EAAE,CAAC;IAC9C,IAAGwD,SAAS,KAAKtB,IAAI,CAACQ,KAAK,CAAC,CAACrC,MAAM,EAAC;MAClC,IAAGqC,KAAK,KAAK,CAAC,CAAC,EAAC;QACdR,IAAI,CAACQ,KAAK,CAAC,CAACrC,MAAM,GAAGmD,SAAS;;MAEhC,IAAI,CAAC/B,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;MACzB,IAAI,CAACN,gBAAgB,CAACM,IAAI,CAACQ,KAAK,CAAC,EAAE,MAAM,CAAC;;EAG9C;EACAe,MAAM,CAACxB,IAAU;IACf,IAAIC,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACpCG,IAAI,GAAGA,IAAI,CAACW,MAAM,CAACD,CAAC,IAAIA,CAAC,KAAKX,IAAI,CAAC;IACnC,IAAI,CAACR,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;EAC3B;EACAwB,SAAS;IACP,IAAIxB,IAAI,GAAG,IAAI,CAACT,SAAS,CAACM,QAAQ,EAAE;IACpCG,IAAI,GAAG,EAAE;IACT,IAAI,CAACT,SAAS,CAACJ,IAAI,CAACa,IAAI,CAAC;EAC3B;EACAyB,cAAc;IACZ,OAAO,IAAI,CAAClC,SAAS,CAACmC,YAAY,EAAE;EACtC;EACAC,gBAAgB;IACd,OAAO,IAAI,CAACrC,WAAW,CAACoC,YAAY,EAAE;EACxC;EACAE,iBAAiB;IACf,OAAO,IAAI,CAAC1C,QAAQ,CAACwC,YAAY,EAAE;EACrC;EACAhC,gBAAgB,CAACmB,IAAU,EAAIgB,MAAqD;IACjF,IAAIC,KAAK,GAAGjB,IAAI,CAAC7C,OAAO,CAAC+D,cAAc,EAAE;IACzC,IAAIC,KAAK,GAAG,IAAI/D,IAAI,EAAE,CAACgE,kBAAkB,EAAE;IAC3C,IAAIC,KAAK,GAAGrB,IAAI,CAACtC,GAAG,EAAE0D,kBAAkB,EAAE;IAE1C,IAAIE,IAAI,GAAkB,IAAI,CAACjD,QAAQ,CAACW,QAAQ,EAAE;IAClD,IAAIE,IAAI,GAAW,EAAE;IAGlB,QAAQ8B,MAAM;MACZ,KAAK,KAAK;QACT9B,IAAI,GAAI+B,KAAK,GAAI,KAAK,GAAIjB,IAAI,CAACzC,UAAU,GAAG,mBAAmB,GAAGyC,IAAI,CAAC9C,IAAI,GAAG,GAAG,GAAG8C,IAAI,CAAC/C,EAAE,GAAG,GAAG;QAClG;MACA,KAAK,QAAQ;QACZiC,IAAI,GAAGiC,KAAK,GAAI,KAAK,GAAI,IAAI,CAACI,YAAY,GAAG,iBAAiB,GAAGvB,IAAI,CAAC9C,IAAI,GAAG,GAAG,GAAG8C,IAAI,CAAC/C,EAAE,GAAG,GAAG;QACjG;MACA,KAAK,MAAM;QACXiC,IAAI,GAAGiC,KAAK,GAAI,KAAK,GAAI,IAAI,CAACI,YAAY,GAAG,gBAAgB,GAAGvB,IAAI,CAAC9C,IAAI,GAAG,GAAG,GAAG8C,IAAI,CAAC/C,EAAE,GAAG,GAAG;QAC/F;MACA,KAAK,MAAM;QACXiC,IAAI,GAAGmC,KAAK,GAAI,KAAK,GAAIrB,IAAI,CAAC1C,MAAM,GAAG,kBAAkB,GAAG0C,IAAI,CAAC9C,IAAI,GAAG,GAAG,GAAG8C,IAAI,CAAC/C,EAAE,GAAG,GAAG;QAC3F;MACA,KAAK,QAAQ;QACbiC,IAAI,GAAGiC,KAAK,GAAI,KAAK,GAAI,IAAI,CAACI,YAAY,GAAG,gBAAgB,GAAGvB,IAAI,CAAC9C,IAAI,GAAG,GAAG,GAAG8C,IAAI,CAAC/C,EAAE,GAAG,GAAG;QAC/F;IAAM;IAGVqE,IAAI,CAAClC,IAAI,CAACF,IAAI,CAAC;IACf,IAAI,CAACb,QAAQ,CAACC,IAAI,CAACgD,IAAI,CAAC;EAE1B;EACF/B,kBAAkB,CAACS,IAAY,EAAEgB,MAAiC;IAChE,IAAIQ,IAAI,GAAG,IAAIpE,IAAI,EAAE,CAACgE,kBAAkB,EAAE;IAC1C,IAAIE,IAAI,GAAkB,IAAI,CAACjD,QAAQ,CAACW,QAAQ,EAAE;IAClD,IAAIE,IAAI,GAAW,EAAE;IACrB,QAAQ8B,MAAM;MACZ,KAAK,KAAK;QACT9B,IAAI,GAAIsC,IAAI,GAAI,KAAK,GAAI,IAAI,CAACD,YAAY,GAAI,qBAAqB,GAAGvB,IAAI,CAAC9C,IAAI;QAChF;MACA,KAAK,QAAQ;QACZgC,IAAI,GAAGsC,IAAI,GAAI,KAAK,GAAI,IAAI,CAACD,YAAY,GAAG,mBAAmB,GAAGvB,IAAI,CAAC9C,IAAI;QAC5E;MACA,KAAK,MAAM;QACXgC,IAAI,GAAGsC,IAAI,GAAI,KAAK,GAAI,IAAI,CAACD,YAAY,GAAG,kBAAkB,GAAGvB,IAAI,CAAC9C,IAAI;QAC1E;IAAM;IAERoE,IAAI,CAAClC,IAAI,CAACF,IAAI,CAAC;IACf,IAAI,CAACb,QAAQ,CAACC,IAAI,CAACgD,IAAI,CAAC;EAC1B;;AAjNWxE,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;SAAZA,YAAY;EAAA2E,SAAZ3E,YAAY;EAAA4E,YAFX;AAAM","names":["BehaviorSubject","TasksService","constructor","taskList","id","name","created","Date","isDone","member","assignedBy","importance","deadline","end","members","class","color","storedHistory","localStorage","getItem","storedMembers","storedTasks","console","log","history$","next","JSON","parse","memberList$","taskList$","i","length","addTaskToHistory","setItem","stringify","getValue","add","task","list","push","addMember","mem","addMemberToHistory","deleteMember","active","mems","index","findIndex","e","filter","map","item","splice","done","undone","editTask","value","for","urgent","dropTask","newMember","remove","deleteall","getTaskListObs","asObservable","getMemberListObs","getHistoryListObs","action","cDate","toLocaleString","aDate","toLocaleDateString","eDate","hist","activeMember","date","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Sebastian\\Desktop\\Pages\\angapp\\src\\app\\services\\tasks.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable } from 'rxjs';\nimport { Task } from '../model/task';\nimport { Member } from '../model/member';\nimport { NgForm } from '@angular/forms';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TasksService {\n  \n\n  private taskList$ = new BehaviorSubject<Array<Task>>([]);\n  private memberList$ = new BehaviorSubject<Array<Member>>([]);\n  private history$ = new BehaviorSubject<Array<string>>([]);\n  public activeMember: string = ''\n\n  constructor() {\n   const taskList = [\n      {id: 528, name: 'Water Plants', created: new Date('2023-04-23 18:10:53'), isDone: false, member: 'John', assignedBy: 'Daphne', importance: 'normal', deadline: new Date('2023-05-23 18:10:53') },\n      {id: 529, name: 'Walk the dog', created: new Date('2023-03-22 17:10:10'), isDone: false, member: 'Mark', assignedBy: 'Daphne', importance: 'low', deadline: new Date('2023-05-23 18:10:53')   },\n      {id: 530, name: 'Grocery shopping', created: new Date('2024-07-21 20:05:55'), isDone: false, member: 'Mark', assignedBy: 'Mark',  importance: 'high', deadline: new Date('2023-05-23 18:10:53')   },\n      {id: 531, name: 'Change sheets', created: new Date('2023-02-21 03:29:11'), isDone: false, member: 'Daphne', assignedBy: 'Mark', importance: 'high', deadline: new Date('2023-05-23 18:10:53')   },\n      {id: 532, name: 'Learn Angular', created: new Date('2023-04-23 15:11:11'), isDone: false, member: 'Daphne',assignedBy: 'Daphne', importance: 'normal', deadline: new Date('2023-05-23 18:10:53')   },\n      {id: 533, name: 'Clean the kitchen', created: new Date('2023-03-21 13:19:14'), end: new Date('2022-07-25 18:29:41'), isDone: true, member: 'Julian', assignedBy: 'Mark', importance: 'low', deadline: new Date('2023-05-23 18:10:53')  },\n      {id: 534, name: 'Laundry', created: new Date('2023-02-05 05:21:57'), end: new Date('2022-07-25 18:54:11'), isDone: true, member: 'Julian',assignedBy: 'Mark', importance: 'low', deadline: new Date('2023-05-23 18:10:53')},\n      {id: 526, name: 'Wash the car', created: new Date('2023-02-04 01:21:54'),  isDone: false, member: 'John',assignedBy: 'John', importance: 'low', deadline: new Date('2023-05-23 18:10:53')},\n      {id: 525, name: 'Wrap presents', created: new Date('2023-02-03 04:11:57'), isDone: false, member: 'Julian',assignedBy: 'John', importance: 'low', deadline: new Date('2023-05-23 18:10:53')},\n      {id: 527, name: 'Clean the fireplace', created: new Date('2023-02-04 05:11:17'), isDone: false, member: 'Julian',assignedBy: 'Mark', importance: 'normal', deadline: new Date('2023-05-23 18:10:53')}\n    ]\n    const members: Array<Member> = [\n      {name: 'John', class: 'Adult', color: 'var(--fandango)'},\n      {name: 'Daphne', class: 'Adult', color: 'var(--thulian-pink)'},\n      {name: 'Mark', class: 'Child', color: 'var(--dutch-white)'},\n      {name: 'Julian', class: 'Child', color: 'var(--ice-blue)'},\n    ]\n   \n    \n\n    const storedHistory = localStorage.getItem('history')\n    const storedMembers = localStorage.getItem('members')\n    const storedTasks = localStorage.getItem('tasks')\n\n    if (storedHistory && storedMembers && storedTasks) {\n      console.log(storedHistory)\n      this.history$.next(JSON.parse(storedHistory))\n      this.memberList$.next(JSON.parse(storedMembers))\n      this.taskList$.next(JSON.parse(storedTasks))\n    } else {\n\n      this.memberList$.next(members)\n      this.taskList$.next(taskList);\n      for(let i = 0; i < taskList.length ; i++){\n        this.addTaskToHistory(taskList[i], 'add')\n      }\n      \n      localStorage.setItem(\"members\", JSON.stringify(members));\n      localStorage.setItem(\"tasks\", JSON.stringify(taskList));\n      localStorage.setItem(\"history\", JSON.stringify(this.history$.getValue()));\n    }\n   \n\n  }\n\n  \n\n\n  add(task: Task): void {\n    const list = this.taskList$.getValue();\n    list.push(task)\n    this.taskList$.next(list);\n\n    this.addTaskToHistory(task, 'add')\n  }\n  addMember(member: Member){\n    const mem = this.memberList$.getValue()\n    mem.push(member)\n    this.memberList$.next(mem)\n    localStorage.setItem('members', JSON.stringify(mem))\n    this.addMemberToHistory(member, 'add')\n  }\n  deleteMember(member:string, active:string){\n    var list = this.taskList$.getValue()\n    var mems = this.memberList$.getValue()\n    const index = mems.findIndex(e => e.name === active)\n\n    if(member === 'delete'){\n      list = list.filter((e)=> e.member !== active);\n      this.taskList$.next(list)\n\n    } else {\n      list = list.map(item => {\n        if (item.member === active) {\n          return { ...item, member: member };\n        } else {\n          return item;\n        }\n      });\n      this.taskList$.next(list)\n    }\n\n    this.addMemberToHistory(mems[index], 'delete')\n    mems.splice(index,1)\n   \n  }\n  done(task: Task) {\n    task.end = new Date();\n    task.isDone = true;\n    var list = this.taskList$.getValue();\n    this.taskList$.next(list);\n    this.addTaskToHistory(task, 'done')\n  }\n  undone(task: Task){\n    task.isDone = false;\n    delete task.end\n    let list = this.taskList$.getValue();\n    this.taskList$.next(list)\n    this.addTaskToHistory(task, 'undone')\n    \n  }\n  editTask(task:NgForm, id:number){\n    var list = this.taskList$.getValue()\n\n    const index = list.findIndex(e => e.id === id)\n\n    if (index !== -1) {\n      list[index].name = task.value.name\n      list[index].deadline = task.value.deadline\n      list[index].assignedBy = task.value.for\n      list[index].importance = task.value.urgent;\n      list[index].created = task.value.created;\n      if(task.value.member){\n      list[index].member = task.value.member\n      }\n    }\n\n    this.taskList$.next(list)\n    this.addTaskToHistory(list[index], 'edit')\n  }\n  dropTask(id:number, newMember:string){\n    var list = this.taskList$.getValue()\n    const index = list.findIndex(e => e.id === id)\n    if(newMember !== list[index].member){\n      if(index !== -1){\n        list[index].member = newMember\n      }\n      this.taskList$.next(list)\n      this.addTaskToHistory(list[index], 'edit')\n    }\n    \n  }\n  remove(task: Task) {\n    var list = this.taskList$.getValue();\n    list = list.filter(e => e !== task);\n    this.taskList$.next(list);\n  }\n  deleteall() {\n    var list = this.taskList$.getValue();\n    list = [];\n    this.taskList$.next(list);\n  }\n  getTaskListObs(): Observable<Array<Task>> {\n    return this.taskList$.asObservable();\n  }\n  getMemberListObs(): Observable<Array<Member>>{\n    return this.memberList$.asObservable();\n  }\n  getHistoryListObs(): Observable<Array<string>>{\n    return this.history$.asObservable();\n  }\n  addTaskToHistory(item: Task ,  action: 'add' | 'delete' | 'edit' | 'done' | 'undone' ){\n     let cDate = item.created.toLocaleString()\n     let aDate = new Date().toLocaleDateString()\n     let eDate = item.end?.toLocaleDateString()\n\n     let hist: Array<string> = this.history$.getValue();\n     let task: string = ''\n     \n   \n        switch (action){\n          case 'add':                  \n           task =  cDate  + ' - ' +  item.assignedBy + ' added new task: ' + item.name + '(' + item.id + ')';\n          break;\n          case 'delete':            \n           task = aDate  + ' - ' +  this.activeMember + ' deleted task: ' + item.name + '(' + item.id + ')';\n          break;\n          case 'edit':        \n          task = aDate  + ' - ' +  this.activeMember + ' edited task: ' + item.name + '(' + item.id + ')';\n          break;\n          case 'done':           \n          task = eDate  + ' - ' +  item.member + ' finished task: ' + item.name + '(' + item.id + ')';\n          break;\n          case 'undone':           \n          task = aDate  + ' - ' +  this.activeMember + ' undone task: ' + item.name + '(' + item.id + ')';\n          break;\n          \n        }\n      hist.push(task)\n      this.history$.next(hist)\n      \n    }\n  addMemberToHistory(item: Member, action: 'add' | 'edit' | 'delete'){\n    let date = new Date().toLocaleDateString();\n    let hist: Array<string> = this.history$.getValue();\n    let task: string = '';\n    switch (action){\n      case 'add':                  \n       task =  date  + ' - ' +  this.activeMember  + ' added new member: ' + item.name\n      break;\n      case 'delete':            \n       task = date  + ' - ' +  this.activeMember + ' deleted member: ' + item.name\n      break;\n      case 'edit':        \n      task = date  + ' - ' +  this.activeMember + ' edited member: ' + item.name \n      break;  \n    }\n    hist.push(task)\n    this.history$.next(hist)\n  }\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}